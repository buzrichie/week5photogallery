<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Photo Gallery</title>
    <meta charset="UTF-8">
    <style>
        .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
        .image-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; }
        .image-card img { max-width: 100%; height: auto; }
        .upload-form { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>
<h1>Photo Gallery</h1>

<!-- Upload Form -->
<div class="upload-form">
    <h2>Upload New Image</h2>
    <form th:action="@{/upload}" method="post">
        <div>
            <label>Description:</label>
            <input type="text" name="description" required>
        </div>
        <div>
            <label>Image File Name:</label>
            <input type="text" name="fileName" placeholder="example.jpg" required>
        </div>
        <button type="submit">Prepare Upload</button>
    </form>

    <div th:if="${uploadUrl}">
        <h3>Upload Instructions:</h3>
        <p>Use this URL to upload your image (valid for 10 minutes):</p>
        <pre th:text="${uploadUrl}"></pre>
        <p>After uploading, refresh the page to see your image.</p>
    </div>
</div>

<!-- Messages -->
<div th:if="${message}" style="color: green;" th:text="${message}"></div>
<div th:if="${error}" style="color: red;" th:text="${error}"></div>

<!-- Gallery -->
<div class="gallery">
    <div th:each="image : ${images}" class="image-card">
        <img th:src="${image.presignedUrl}" th:alt="${image.description}">
        <p th:text="${image.description}"></p>
        <small th:text="${#temporals.format(image.createdAt, 'yyyy-MM-dd HH:mm')}"></small>
    </div>
</div>
</body>
</html>